2025-08-25 23:53:22.966 | INFO     | risk.db:load_data_from_db:14 - Loading data from table 'beneficiary5'
2025-08-25 23:53:27.685 | WARNING  | __main__:<module>:88 - DB load failed: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8). Falling back to CSV.
2025-08-25 23:54:03.588 | INFO     | risk.db:load_data_from_db:14 - Loading data from table 'beneficiary5'
2025-08-25 23:54:07.680 | WARNING  | __main__:<module>:88 - DB load failed: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8). Falling back to CSV.
2025-08-25 23:54:08.055 | INFO     | __main__:<module>:90 - Loaded 56641 rows from CSV.
2025-08-25 23:54:08.056 | INFO     | risk.model:train_model:119 - Starting training...
2025-08-25 23:54:10.457 | INFO     | risk.model:train_model:154 - RISK_30D: MAE=6.355, R²=0.936
2025-08-25 23:54:11.049 | INFO     | risk.model:train_model:154 - RISK_60D: MAE=6.553, R²=0.935
2025-08-25 23:54:11.667 | INFO     | risk.model:train_model:154 - RISK_90D: MAE=6.839, R²=0.933
2025-08-25 23:54:44.581 | SUCCESS  | risk.model:train_model:163 - Model saved to models/risk_model.pkl
2025-08-25 23:55:22.214 | INFO     | risk.db:load_data_from_db:14 - Loading data from table 'beneficiary5'
2025-08-26 09:18:04.907 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-26 09:18:04.910 | INFO     | risk.db:load_data_from_db:10 - Loading data from beneficiary5
2025-08-26 09:30:47.308 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-26 09:30:47.326 | INFO     | risk.db:load_data_from_db:10 - Loading data from beneficiary5
2025-08-26 11:32:45.054 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-26 11:32:45.061 | INFO     | risk.db:load_data_from_db:10 - Loading data from beneficiary5
2025-08-26 11:44:31.600 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-26 11:44:31.604 | INFO     | risk.db:load_data_from_db:10 - Loading data from beneficiary
2025-08-27 20:46:45.779 | INFO     | __main__:check_database:56 - Checking database status...
2025-08-27 20:46:45.835 | ERROR    | __main__:check_database:78 - Database check failed: Not an executable object: "SELECT name FROM sqlite_master WHERE type='table'"
2025-08-27 20:51:01.536 | INFO     | __main__:setup_database:14 - Setting up SQLite database...
2025-08-27 20:51:01.537 | INFO     | __main__:setup_database:28 - Found CSV files: ['risk_training.csv']
2025-08-27 20:51:01.538 | INFO     | __main__:setup_database:36 - Creating table 'risk_training' from 'risk_training.csv'...
2025-08-27 20:51:01.538 | INFO     | risk.db:create_table_from_csv:131 - Creating table risk_training from data\risk_training.csv
2025-08-27 20:51:03.356 | SUCCESS  | risk.db:create_table_from_csv:137 - Table risk_training created with 56641 rows
2025-08-27 20:51:03.363 | SUCCESS  | __main__:setup_database:40 - Database setup completed. 1/1 tables created successfully.
2025-08-27 20:51:03.365 | WARNING  | __main__:setup_database:50 - Could not list tables: Not an executable object: "SELECT name FROM sqlite_master WHERE type='table'"
2025-08-27 20:51:43.658 | INFO     | __main__:check_database:57 - Checking database status...
2025-08-27 20:51:43.695 | SUCCESS  | __main__:check_database:66 - Database is ready with 1 tables: ['risk_training']
2025-08-27 20:51:43.700 | INFO     | __main__:check_database:72 - Table 'risk_training' has 5 sample rows
2025-08-27 20:51:49.758 | INFO     | __main__:setup_database:15 - Setting up SQLite database...
2025-08-27 20:51:49.758 | INFO     | __main__:setup_database:29 - Found CSV files: ['risk_training.csv']
2025-08-27 20:51:49.760 | INFO     | __main__:setup_database:37 - Creating table 'risk_training' from 'risk_training.csv'...
2025-08-27 20:51:49.760 | INFO     | risk.db:create_table_from_csv:131 - Creating table risk_training from data\risk_training.csv
2025-08-27 20:51:51.502 | SUCCESS  | risk.db:create_table_from_csv:137 - Table risk_training created with 56641 rows
2025-08-27 20:51:51.504 | SUCCESS  | __main__:setup_database:41 - Database setup completed. 1/1 tables created successfully.
2025-08-27 20:51:51.507 | INFO     | __main__:setup_database:49 - Tables in database: ['risk_training']
2025-08-27 20:53:01.028 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-27 20:53:01.030 | INFO     | risk.db:load_data_from_db:12 - Loading data from beneficiary
2025-08-27 20:53:45.495 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-27 20:53:45.495 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 20:54:28.396 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-27 20:54:28.396 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 20:55:03.296 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-27 20:55:03.297 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 20:56:24.586 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 20:57:58.304 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-27 20:57:58.304 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 20:58:01.895 | SUCCESS  | __main__:<module>:108 - Model trained & saved
2025-08-27 20:58:14.658 | INFO     | __main__:<module>:78 - Loading trained model...
2025-08-27 20:58:14.700 | INFO     | __main__:<module>:81 - Loading new data...
2025-08-27 20:58:14.703 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 20:58:46.092 | INFO     | __main__:<module>:78 - Loading trained model...
2025-08-27 20:58:46.097 | INFO     | __main__:<module>:81 - Loading new data...
2025-08-27 20:58:46.097 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 20:59:17.349 | INFO     | __main__:<module>:78 - Loading trained model...
2025-08-27 20:59:17.359 | INFO     | __main__:<module>:81 - Loading new data...
2025-08-27 20:59:17.359 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 20:59:18.614 | INFO     | risk.db:ensure_prediction_columns:34 - Ensuring prediction columns exist in risk_training
2025-08-27 20:59:18.617 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_30D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_30D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_30D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 20:59:18.618 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_60D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_60D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_60D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 20:59:18.619 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_90D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_90D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_90D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 20:59:18.620 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_LABEL might already exist: (sqlite3.OperationalError) duplicate column name: RISK_LABEL
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_LABEL TEXT]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 20:59:18.628 | INFO     | risk.db:ensure_prediction_columns:63 - Added column TOP_3_FEATURES to risk_training
2025-08-27 21:04:37.915 | INFO     | __main__:check_database:57 - Checking database status...
2025-08-27 21:04:37.949 | SUCCESS  | __main__:check_database:66 - Database is ready with 1 tables: ['risk_training']
2025-08-27 21:04:37.957 | INFO     | __main__:check_database:72 - Table 'risk_training' has 5 sample rows
2025-08-27 21:04:46.298 | INFO     | __main__:setup_database:15 - Setting up SQLite database...
2025-08-27 21:04:46.299 | INFO     | __main__:setup_database:29 - Found CSV files: ['risk_training.csv']
2025-08-27 21:04:46.300 | INFO     | __main__:setup_database:37 - Creating table 'risk_training' from 'risk_training.csv'...
2025-08-27 21:04:46.300 | INFO     | risk.db:create_table_from_csv:131 - Creating table risk_training from data\risk_training.csv
2025-08-27 21:04:47.624 | SUCCESS  | risk.db:create_table_from_csv:137 - Table risk_training created with 56641 rows
2025-08-27 21:04:47.628 | SUCCESS  | __main__:setup_database:41 - Database setup completed. 1/1 tables created successfully.
2025-08-27 21:04:47.631 | INFO     | __main__:setup_database:49 - Tables in database: ['risk_training']
2025-08-27 21:04:56.534 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-27 21:04:56.534 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 21:04:59.593 | SUCCESS  | __main__:<module>:108 - Model trained & saved
2025-08-27 21:05:09.679 | INFO     | __main__:<module>:78 - Loading trained model...
2025-08-27 21:05:09.692 | INFO     | __main__:<module>:81 - Loading new data...
2025-08-27 21:05:09.693 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 21:05:10.624 | INFO     | risk.db:ensure_prediction_columns:34 - Ensuring prediction columns exist in risk_training
2025-08-27 21:05:10.627 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_30D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_30D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_30D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:05:10.627 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_60D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_60D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_60D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:05:10.627 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_90D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_90D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_90D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:05:10.628 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_LABEL might already exist: (sqlite3.OperationalError) duplicate column name: RISK_LABEL
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_LABEL TEXT]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:05:10.631 | INFO     | risk.db:ensure_prediction_columns:63 - Added column TOP_3_FEATURES to risk_training
2025-08-27 21:21:29.049 | SUCCESS  | risk.db:update_predictions_in_db:91 - Predictions updated successfully in DB
2025-08-27 21:31:13.689 | INFO     | __main__:<module>:78 - Loading trained model...
2025-08-27 21:31:13.699 | INFO     | __main__:<module>:81 - Loading new data...
2025-08-27 21:31:13.699 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 21:31:14.904 | INFO     | risk.db:ensure_prediction_columns:34 - Ensuring prediction columns exist in risk_training
2025-08-27 21:31:14.906 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_30D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_30D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_30D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:31:14.907 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_60D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_60D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_60D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:31:14.908 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_90D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_90D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_90D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:31:14.908 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column RISK_LABEL might already exist: (sqlite3.OperationalError) duplicate column name: RISK_LABEL
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_LABEL TEXT]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:31:14.908 | DEBUG    | risk.db:ensure_prediction_columns:66 - Column TOP_3_FEATURES might already exist: (sqlite3.OperationalError) duplicate column name: TOP_3_FEATURES
[SQL: ALTER TABLE risk_training ADD COLUMN TOP_3_FEATURES TEXT]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:47:18.437 | INFO     | __main__:<module>:78 - Loading trained model...
2025-08-27 21:47:18.446 | INFO     | __main__:<module>:81 - Loading new data...
2025-08-27 21:47:18.446 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-27 21:47:19.675 | INFO     | risk.db:ensure_prediction_columns:34 - Ensuring prediction columns exist in risk_training
2025-08-27 21:47:19.680 | DEBUG    | risk.db:ensure_prediction_columns:67 - Column RISK_30D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_30D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_30D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:47:19.682 | DEBUG    | risk.db:ensure_prediction_columns:67 - Column RISK_60D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_60D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_60D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:47:19.683 | DEBUG    | risk.db:ensure_prediction_columns:67 - Column RISK_90D might already exist: (sqlite3.OperationalError) duplicate column name: RISK_90D
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_90D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:47:19.685 | DEBUG    | risk.db:ensure_prediction_columns:67 - Column RISK_LABEL might already exist: (sqlite3.OperationalError) duplicate column name: RISK_LABEL
[SQL: ALTER TABLE risk_training ADD COLUMN RISK_LABEL TEXT]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:47:19.685 | DEBUG    | risk.db:ensure_prediction_columns:67 - Column TOP_3_FEATURES might already exist: (sqlite3.OperationalError) duplicate column name: TOP_3_FEATURES
[SQL: ALTER TABLE risk_training ADD COLUMN TOP_3_FEATURES TEXT]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 21:47:19.692 | INFO     | risk.db:ensure_prediction_columns:64 - Added column AI_RECOMMENDATIONS to risk_training
2025-08-27 22:09:20.403 | SUCCESS  | risk.db:update_predictions_in_db:94 - Predictions updated successfully in DB
2025-08-27 22:09:20.407 | INFO     | __main__:predict_single:142 - Prediction completed and database updated for patient 7C04F6D97F5A2815: {'DESYNPUF_ID': '7C04F6D97F5A2815', 'RISK_30D': 99, 'RISK_60D': 99, 'RISK_90D': 99, 'RISK_LABEL': 'Very High Risk', 'TOP_3_FEATURES': 'COMOR_COUNT, HEARTFAILURE, ALZHEIMER', 'AI_RECOMMENDATIONS': '1. Cardiology consultation for heart failure management | 2. Implement sodium-restricted diet | 3. Daily weight monitoring recommended'}
2025-08-27 22:22:01.969 | INFO     | __main__:predict_single:108 - Prediction completed for new patient: {'DESYNPUF_ID': 'NEW_1756313521205', 'RISK_30D': 94, 'RISK_60D': 94, 'RISK_90D': 94, 'RISK_LABEL': 'Very High Risk', 'TOP_3_FEATURES': 'COMOR_COUNT, HEARTFAILURE, ALZHEIMER', 'AI_RECOMMENDATIONS': '1. Cardiology consultation for heart failure management | 2. Implement sodium-restricted diet | 3. Daily weight monitoring recommended'}
2025-08-27 22:25:25.068 | INFO     | risk.email_service:init_email_service:27 - Email service initialized
2025-08-27 22:25:25.322 | INFO     | risk.email_service:init_email_service:27 - Email service initialized
2025-08-27 22:25:26.003 | INFO     | risk.email_service:init_email_service:27 - Email service initialized
2025-08-27 22:26:31.700 | INFO     | risk.email_service:init_email_service:27 - Email service initialized
2025-08-27 22:26:32.528 | INFO     | risk.email_service:init_email_service:27 - Email service initialized
2025-08-27 22:26:32.646 | INFO     | risk.email_service:init_email_service:27 - Email service initialized
2025-08-27 22:26:47.912 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:26:47.937 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:26:48.008 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:27:01.543 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:27:09.403 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:01.603 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:01.603 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:01.605 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:01.690 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:50.288 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:50.289 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:50.291 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:50.291 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:28:50.877 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 100
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 22:29:03.295 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 50
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 22:30:54.233 | INFO     | __main__:predict_single:119 - Prediction completed for new patient: {'DESYNPUF_ID': 'NEW_1756314053626', 'RISK_30D': 95, 'RISK_60D': 94, 'RISK_90D': 92, 'RISK_LABEL': 'Very High Risk', 'TOP_3_FEATURES': 'COMOR_COUNT, HEARTFAILURE, BP_S', 'AI_RECOMMENDATIONS': '1. Cardiology consultation for heart failure management | 2. Implement sodium-restricted diet | 3. Daily weight monitoring recommended'}
2025-08-27 22:30:54.252 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 50
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 22:31:05.490 | ERROR    | __main__:send_bulk_emails_endpoint:278 - Bulk email sending error: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT * FROM risk_training 
        WHERE RISK_LABEL IN ('Very High Risk', 'High Risk')
        AND AI_RECOMMENDATIONS IS NOT NULL
        AND EMAIL IS NOT NULL
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 22:36:10.932 | ERROR    | __main__:send_bulk_emails_endpoint:278 - Bulk email sending error: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT * FROM risk_training 
        WHERE RISK_LABEL IN ('Very High Risk', 'High Risk')
        AND AI_RECOMMENDATIONS IS NOT NULL
        AND EMAIL IS NOT NULL
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 22:37:33.203 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:37:33.206 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:37:33.207 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:37:33.220 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:37:46.139 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:37:46.457 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:37:46.473 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:37:46.476 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:39:22.871 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:39:22.871 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:39:22.871 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:39:22.871 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:52:34.630 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:52:34.644 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:52:34.662 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:52:34.666 | INFO     | risk.email_service:init_email_service:31 - Email service initialized with custom configuration
2025-08-27 22:53:03.714 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:53:03.717 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:53:03.723 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:53:03.925 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:53:58.752 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:53:58.753 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:53:58.755 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:53:58.826 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:54:48.547 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:54:48.560 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:54:48.650 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:54:48.657 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:58:25.980 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:59:05.883 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:59:15.092 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:59:15.096 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:59:15.270 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 22:59:15.302 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:04.582 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:07.329 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:07.395 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:07.528 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:07.655 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:45.773 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:45.969 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:46.051 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:46.074 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:00:46.097 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:02:07.292 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 100
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 23:03:08.646 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 100
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 23:03:35.003 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 100
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 23:03:38.673 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 50
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 23:04:47.429 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 100
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 23:06:49.581 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:06:51.548 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:06:52.099 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:06:52.190 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:06:52.510 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:06:57.873 | ERROR    | __main__:get_database_data:40 - Error loading data: (sqlite3.OperationalError) no such column: EMAIL
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM risk_training 
        ORDER BY RISK_30D DESC 
        LIMIT 100
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-27 23:10:23.513 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:10:23.921 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:10:23.934 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:10:24.050 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:10:24.677 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:10:56.916 | ERROR    | risk.db:ensure_prediction_columns:61 - Error ensuring prediction columns: 'Engine' object has no attribute 'execute'
2025-08-27 23:11:51.100 | INFO     | risk.db:ensure_prediction_columns:60 - Added column EMAIL to risk_training
2025-08-27 23:12:18.600 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:12:23.361 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:12:23.490 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:12:23.609 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:12:23.705 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:14:06.997 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:14:09.393 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:14:09.464 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:14:09.792 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:14:09.810 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:14:13.806 | ERROR    | risk.db:update_patient_email:162 - Error updating email for patient 7C04F6D97F5A2815: 'Engine' object has no attribute 'execute'
2025-08-27 23:15:20.115 | ERROR    | risk.db:update_patient_email:162 - Error updating email for patient 7C04F6D97F5A2815: 'Engine' object has no attribute 'execute'
2025-08-27 23:15:51.668 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:24:45.488 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:25:21.063 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:25:21.914 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:25:52.447 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:43:15.706 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:43:31.786 | ERROR    | risk.db:update_patient_email:162 - Error updating email for patient 7C04F6D97F5A2815: 'Engine' object has no attribute 'execute'
2025-08-27 23:45:54.516 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:47:03.267 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:50:47.512 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:51:10.146 | ERROR    | risk.db:update_patient_email:162 - Error updating email for patient 7C04F6D97F5A2815: 'Engine' object has no attribute 'execute'
2025-08-27 23:53:07.846 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:53:10.336 | ERROR    | risk.db:update_patient_email:162 - Error updating email for patient 7C04F6D97F5A2815: 'Engine' object has no attribute 'execute'
2025-08-27 23:53:32.153 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:55:22.691 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-27 23:55:27.921 | INFO     | risk.db:update_patient_email:160 - Email updated for patient 7C04F6D97F5A2815: test-update@example.com
2025-08-27 23:55:45.029 | INFO     | risk.db:update_patient_email:160 - Email updated for patient 7C04F6D97F5A2815: test@example.com
2025-08-27 23:59:59.543 | ERROR    | risk.email_service:send_recommendations_email:121 - Error sending email to test@example.com: (535, b'5.7.8 Username and Password not accepted. For more information, go to\n5.7.8  https://support.google.com/mail/?p=BadCredentials 98e67ed59e1d1-3278c26c543sm1313966a91.28 - gsmtp')
2025-08-28 00:03:33.725 | INFO     | __main__:predict_single:119 - Prediction completed for new patient: {'DESYNPUF_ID': 'NEW_1756319612507', 'RISK_30D': 96, 'RISK_60D': 97, 'RISK_90D': 96, 'RISK_LABEL': 'Very High Risk', 'TOP_3_FEATURES': 'COMOR_COUNT, HEARTFAILURE, ALZHEIMER', 'AI_RECOMMENDATIONS': '1. Cardiology consultation for heart failure management | 2. Implement sodium-restricted diet | 3. Daily weight monitoring recommended'}
2025-08-28 00:04:20.565 | INFO     | risk.db:update_patient_email:160 - Email updated for patient 660CE6AD58F2A1B9: highrisk7@example.com
2025-08-28 00:06:26.834 | ERROR    | risk.db:get_patient_by_id:186 - Error getting patient 7C04F6D97F5A2815: dictionary update sequence element #0 has length 16; 2 is required
2025-08-28 00:13:20.881 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:03:48.311 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:03:58.150 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:07:38.759 | INFO     | __main__:predict_single:119 - Prediction completed for new patient: {'DESYNPUF_ID': 'NEW_1756377458293', 'RISK_30D': 82, 'RISK_60D': 83, 'RISK_90D': 86, 'RISK_LABEL': 'High Risk', 'TOP_3_FEATURES': 'COMOR_COUNT, ALZHEIMER, AGE', 'AI_RECOMMENDATIONS': '1. Neurological consultation for cognitive assessment | 2. Implement memory support strategies | 3. Review medication interactions'}
2025-08-28 16:15:15.893 | INFO     | __main__:predict_single:119 - Prediction completed for new patient: {'DESYNPUF_ID': 'NEW_1756377915467', 'RISK_30D': 19, 'RISK_60D': 19, 'RISK_90D': 19, 'RISK_LABEL': 'Very Low Risk', 'TOP_3_FEATURES': 'COMOR_COUNT, AGE, GLUCOSE', 'AI_RECOMMENDATIONS': '1. Continue preventive care routine | 2. Annual wellness visit recommended | 3. Maintain healthy lifestyle practices'}
2025-08-28 16:19:44.426 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:20:11.476 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:20:55.135 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:22:57.098 | ERROR    | risk.email_service:send_recommendations_email:121 - Error sending email to test@example.com: (535, b'5.7.8 Username and Password not accepted. For more information, go to\n5.7.8  https://support.google.com/mail/?p=BadCredentials d2e1a72fcca58-771ebabeeffsm9706357b3a.30 - gsmtp')
2025-08-28 16:22:57.099 | INFO     | risk.email_service:send_bulk_recommendations_emails:136 - Bulk email sending completed: 0/1 high-risk patients
2025-08-28 16:30:41.199 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:30:50.351 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:30:50.489 | INFO     | __main__:predict_single:126 - New patient data saved to database: NEW_TEST_1756378838
2025-08-28 16:30:50.558 | SUCCESS  | risk.db:update_predictions_in_db:89 - Predictions updated successfully in DB
2025-08-28 16:30:50.561 | INFO     | __main__:predict_single:137 - Prediction completed and saved for new patient: {'DESYNPUF_ID': 'NEW_TEST_1756378838', 'RISK_30D': 76, 'RISK_60D': 79, 'RISK_90D': 81, 'RISK_LABEL': 'High Risk', 'TOP_3_FEATURES': 'ALZHEIMER, GLUCOSE, COMOR_COUNT', 'AI_RECOMMENDATIONS': '1. Neurological consultation for cognitive assessment | 2. Implement memory support strategies | 3. Review medication interactions'}
2025-08-28 16:31:20.133 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:33:22.484 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 16:37:51.463 | INFO     | __main__:predict_single:126 - New patient data saved to database: NEW_1756379271064
2025-08-28 16:37:51.595 | SUCCESS  | risk.db:update_predictions_in_db:89 - Predictions updated successfully in DB
2025-08-28 16:37:51.596 | INFO     | __main__:predict_single:137 - Prediction completed and saved for new patient: {'DESYNPUF_ID': 'NEW_1756379271064', 'RISK_30D': 19, 'RISK_60D': 19, 'RISK_90D': 19, 'RISK_LABEL': 'Very Low Risk', 'TOP_3_FEATURES': 'COMOR_COUNT, AGE, GLUCOSE', 'AI_RECOMMENDATIONS': '1. Continue preventive care routine | 2. Annual wellness visit recommended | 3. Maintain healthy lifestyle practices'}
2025-08-28 16:38:19.378 | INFO     | __main__:predict_single:126 - New patient data saved to database: NEW_1756379299025
2025-08-28 16:38:19.438 | SUCCESS  | risk.db:update_predictions_in_db:89 - Predictions updated successfully in DB
2025-08-28 16:38:19.438 | INFO     | __main__:predict_single:137 - Prediction completed and saved for new patient: {'DESYNPUF_ID': 'NEW_1756379299025', 'RISK_30D': 19, 'RISK_60D': 19, 'RISK_90D': 19, 'RISK_LABEL': 'Very Low Risk', 'TOP_3_FEATURES': 'COMOR_COUNT, AGE, GLUCOSE', 'AI_RECOMMENDATIONS': '1. Continue preventive care routine | 2. Annual wellness visit recommended | 3. Maintain healthy lifestyle practices'}
2025-08-28 20:02:00.045 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 20:02:44.613 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 20:19:24.726 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 20:20:20.786 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 20:24:51.589 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 20:31:47.680 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 20:31:51.754 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:17:57.529 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:17:57.529 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:23:10.322 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:29:30.341 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:29:30.354 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:30:22.226 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:30:22.245 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:32:12.550 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:32:12.572 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:32:47.678 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:32:47.680 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:32:58.931 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:32:58.934 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:33:26.368 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:33:26.372 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:33:59.351 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:33:59.353 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:34:11.594 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:34:11.629 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:34:22.876 | INFO     | __main__:predict_single:126 - New patient data saved to database: NEW_TEST_1756397060
2025-08-28 21:34:22.945 | SUCCESS  | risk.db:update_predictions_in_db:89 - Predictions updated successfully in DB
2025-08-28 21:34:22.947 | INFO     | __main__:predict_single:137 - Prediction completed and saved for new patient: {'DESYNPUF_ID': 'NEW_TEST_1756397060', 'RISK_30D': 83, 'RISK_60D': 86, 'RISK_90D': 88, 'RISK_LABEL': 'High Risk', 'TOP_3_FEATURES': 'HEARTFAILURE, COMOR_COUNT, BP_S', 'AI_RECOMMENDATIONS': '1. Cardiology consultation for heart failure management | 2. Implement sodium-restricted diet | 3. Daily weight monitoring recommended'}
2025-08-28 21:34:27.112 | INFO     | risk.db:update_patient_email:160 - Email updated for patient 7C04F6D97F5A2815: test@example.com
2025-08-28 21:35:37.266 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:35:37.305 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:36:53.799 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:36:59.835 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-28 21:37:16.575 | INFO     | __main__:predict_single:126 - New patient data saved to database: NEW_TEST_1756397234
2025-08-28 21:37:16.632 | SUCCESS  | risk.db:update_predictions_in_db:89 - Predictions updated successfully in DB
2025-08-28 21:37:16.633 | INFO     | __main__:predict_single:137 - Prediction completed and saved for new patient: {'DESYNPUF_ID': 'NEW_TEST_1756397234', 'RISK_30D': 83, 'RISK_60D': 86, 'RISK_90D': 88, 'RISK_LABEL': 'High Risk', 'TOP_3_FEATURES': 'HEARTFAILURE, COMOR_COUNT, BP_S', 'AI_RECOMMENDATIONS': '1. Cardiology consultation for heart failure management | 2. Implement sodium-restricted diet | 3. Daily weight monitoring recommended'}
2025-08-28 21:37:20.797 | INFO     | risk.db:update_patient_email:160 - Email updated for patient 7C04F6D97F5A2815: test@example.com
2025-08-31 12:11:37.352 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-31 12:11:43.365 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-31 16:50:39.346 | INFO     | risk.email_service:init_email_service:32 - Email service initialized with custom configuration
2025-08-31 18:49:54.964 | INFO     | __main__:<module>:104 - Loading data for training...
2025-08-31 18:49:54.965 | INFO     | risk.db:load_data_from_db:12 - Loading data from risk_training
2025-08-31 18:49:59.698 | SUCCESS  | __main__:<module>:108 - Model trained & saved
2025-09-01 20:03:57.710 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM trainingk
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:03:57.726 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM trainingk
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:12:13.418 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM trainingk
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:12:13.419 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM trainingk
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:16:15.357 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM trainingk
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:16:15.357 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM trainingk
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:16:36.190 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM trainingk
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:16:36.194 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM trainingk
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:38:03.396 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM trainingk
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:38:03.401 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM trainingk
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:46:20.345 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM trainingk
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:46:20.347 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: training
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM training
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:56:42.495 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: training
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM training
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:56:42.500 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM trainingk
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 20:57:52.105 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: training
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM training
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (50,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:15:03.014 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: trainingk
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM trainingk
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:15:03.015 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: training
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM training
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:20:45.973 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: training
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM training
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:20:45.974 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: training
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM training
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:21:55.037 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such table: training
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM training
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:21:55.038 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such table: training
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM training
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:28:31.995 | ERROR    | __main__:api_predict_all:542 - Bulk predict failed: (sqlite3.OperationalError) no such table: training
[SQL: 
            SELECT * FROM training
            WHERE RISK_30D IS NULL OR RISK_60D IS NULL OR RISK_90D IS NULL
            OR RISK_LABEL IS NULL OR TOP_3_FEATURES IS NULL
        ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:29:00.734 | ERROR    | __main__:api_send_bulk_emails:622 - Bulk send failed: 400 Bad Request: Failed to decode JSON object: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\site-packages\werkzeug\wrappers\request.py", line 611, in get_json
    rv = self.json_module.loads(data)
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\json\provider.py", line 187, in loads
    return json.loads(s, **kwargs)
           ~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 363, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\DELL\Desktop\k\Patient-Risk-Prediction\app.py", line 592, in api_send_bulk_emails
    data = request.json or {}
           ^^^^^^^^^^^^
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\site-packages\werkzeug\wrappers\request.py", line 560, in json
    return self.get_json()
           ~~~~~~~~~~~~~^^
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\site-packages\werkzeug\wrappers\request.py", line 620, in get_json
    rv = self.on_json_loading_failed(e)
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\site-packages\flask\wrappers.py", line 214, in on_json_loading_failed
    return super().on_json_loading_failed(e)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python313\Lib\site-packages\werkzeug\wrappers\request.py", line 645, in on_json_loading_failed
    raise BadRequest(f"Failed to decode JSON object: {e}")
werkzeug.exceptions.BadRequest: 400 Bad Request: Failed to decode JSON object: Expecting value: line 1 column 1 (char 0)

2025-09-01 21:30:02.868 | ERROR    | risk.db:ensure_prediction_columns:63 - Error ensuring prediction columns: (sqlite3.OperationalError) no such table: trainingk
[SQL: ALTER TABLE trainingk ADD COLUMN RISK_30D INTEGER]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:30:02.995 | INFO     | __main__:api_predict:435 - Inserted new patient NEW_1756742402473 into database.
2025-09-01 21:30:03.288 | WARNING  | __main__:api_predict:445 - update_predictions_in_db not available or failed; predictions may not be persisted.
2025-09-01 21:58:07.925 | ERROR    | __main__:api_data:343 - Failed to load data: (sqlite3.OperationalError) no such column: RISK_30D
[SQL: 
        SELECT DESYNPUF_ID, AGE, GENDER, TOTAL_CLAIMS_COST, 
               RISK_30D, RISK_60D, RISK_90D, RISK_LABEL, TOP_3_FEATURES, AI_RECOMMENDATIONS, EMAIL
        FROM training
        ORDER BY RISK_30D DESC
        LIMIT ?
    ]
[parameters: (100,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-01 21:58:07.925 | ERROR    | __main__:api_summary:394 - Summary query failed: (sqlite3.OperationalError) no such column: RISK_30D
[SQL: 
        SELECT 
            COUNT(*) as total_patients,
            AVG(RISK_30D) as avg_risk_30d,
            AVG(RISK_60D) as avg_risk_60d,
            AVG(RISK_90D) as avg_risk_90d,
            COUNT(CASE WHEN RISK_LABEL = 'Very High Risk' THEN 1 END) as very_high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'High Risk' THEN 1 END) as high_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Moderate Risk' THEN 1 END) as moderate_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Low Risk' THEN 1 END) as low_risk,
            COUNT(CASE WHEN RISK_LABEL = 'Very Low Risk' THEN 1 END) as very_low_risk
        FROM training
    ]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
